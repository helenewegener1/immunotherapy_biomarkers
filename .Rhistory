library(signifinder)
# sysdata.rda downlaoded from signifinder github: https://github.com/CaluraLab/signifinder/blob/main/R/sysdata.rda
load('~/Downloads/sysdata.rda')
Tinflam_Ayers #%>% filter(class == 'TInflam') %>% dplyr::select(SYMBOL) %>% unlist() %in% response_scores$TGEP
Tinflam_Ayers %>% filter(class == 'TInflam') %>% dplyr::select(SYMBOL) %>% unlist()
library(dplyr)
EMT_Mak
head(EMT_Mak)
EMT_Thompson
EMT_Thompson %>% head()
Hypoxia_Buffa
Hypoxia_Buffa %>% head()
Hypoxia_Buffa %>% dplyr::select(SYMBOL) %>% unlist()
ImmuneCyt_Rooney
ImmuneCyt_Rooney_genes <- ImmuneCyt_Rooney %>% dplyr::select(SYMBOL) %>% unlist()
Tinflam_Thompson
Tinflam_Ayers_genes <- Tinflam_Ayers %>% filter(class == 'TInflam') %>% dplyr::select(SYMBOL) %>% unlist()
Tinflam_Thompson_genes <- Tinflam_Thompson %>% dplyr::select(SYMBOL) %>% unlist()
TLS_Cabrita
CIN_Carter
CIN_Carter %>% filter(class == 'CIN_25')
CIN_Carter %>% filter(class == 'CIN25')
CIN_Carter %>% filter(class == 'CIN25') %>% dplyr::select(SYMBOL) %>% unlist()
PassON_Du
ECM_Chakravarthy
ECM_Chakravarthy %>% head()
ECM_Chakravarthy$class %>% unique()
ECM_Chakravarthy_up_genes <- ECM_Chakravarthy %>% filter(class == 'ECMup') %>% dplyr::select(SYMBOL) %>% unlist()
VEGFSign()
VEGFSign
VEGF_Hu
VEGF_Hu_genes <- VEGF_Hu %>% dplyr::select(SYMBOL) %>% unlist()
EMT_Mak
EMT_Thompson %>% head()
EMT_Thompson$class %>% unique()
EMT_Thompson$class %>% table()
EMT_Mak$class %>% table()
PassON_Du
PassON_Du %>% head()
PassON_Du$class %>% table()
# Translate genes in dea_file from ensembl to SYMBOLS
mart <- useMart("ensembl", dataset = "hsapiens_gene_ensembl")
library(tidyverse)
library(glue)
library(biomaRt)
library(signifinder)
library(dplyr)
# Translate genes in dea_file from ensembl to SYMBOLS
mart <- useMart("ensembl", dataset = "hsapiens_gene_ensembl")
# Load one DEA file to get genes
tmp_dea_file <- read_csv('out/2025_09_09_DEA_Kim_GC_PB-16-045.csv') %>% rename('genes' = '...1')
mapping_ensembl_to_symbol
# Translate genes in dea_file from ensembl to SYMBOLS
mart <- useMart("ensembl", dataset = "hsapiens_gene_ensembl")
# Load one DEA file to get genes
tmp_dea_file <- read_csv('out/2025_09_09_DEA_Kim_GC_PB-16-045.csv') %>% rename('genes' = '...1')
setwd('~/Documents/projects/project_DGD/cancer_sample_normalization/')
# Load one DEA file to get genes
tmp_dea_file <- read_csv('out/2025_09_09_DEA_Kim_GC_PB-16-045.csv') %>% rename('genes' = '...1')
# Map the ensembl genes in the data to gene symbols
mapping_ensembl_to_symbol <- getBM(
attributes = c("ensembl_gene_id", "hgnc_symbol"),
filters = "ensembl_gene_id",
values = tmp_dea_file$genes,
mart = mart
)
mapping_ensembl_to_symbol
head(mapping_ensembl_to_symbol)
Hypoxia_Buffa_genes
Hypoxia_Buffa_genes <- Hypoxia_Buffa %>% dplyr::select(SYMBOL) %>% unlist()
ImmuneCyt_Rooney_genes <- ImmuneCyt_Rooney %>% dplyr::select(SYMBOL) %>% unlist()
Tinflam_Ayers_genes <- Tinflam_Ayers %>% filter(class == 'TInflam') %>% dplyr::select(SYMBOL) %>% unlist()
Tinflam_Thompson_genes <- Tinflam_Thompson %>% dplyr::select(SYMBOL) %>% unlist()
TLS_Cabrita_genes <- TLS_Cabrita %>% dplyr::select(SYMBOL) %>% unlist()
CIN_Carter_25_genes <- CIN_Carter %>% filter(class == 'CIN25') %>% dplyr::select(SYMBOL) %>% unlist()
CIN_Carter_70_genes <- CIN_Carter %>% filter(class == 'CIN70') %>% dplyr::select(SYMBOL) %>% unlist()
ECM_Chakravarthy_up_genes <- ECM_Chakravarthy %>% filter(class == 'ECMup') %>% dplyr::select(SYMBOL) %>% unlist()
ECM_Chakravarthy_down_genes <- ECM_Chakravarthy %>% filter(class == 'ECMdown') %>% dplyr::select(SYMBOL) %>% unlist()
VEGF_Hu_genes <- VEGF_Hu %>% dplyr::select(SYMBOL) %>% unlist()
Hypoxia_Buffa_genes
ls
ls()
# Find the ensembl mapping of the gene list
mapping_ensembl_to_symbol %>% filter(hgnc_symbol %in% Hypoxia_Buffa_genes)
gene_lists_symbol <- list(
Hypoxia_Buffa_genes, ImmuneCyt_Rooney_genes, Tinflam_Ayers_genes,
Tinflam_Thompson_genes, TLS_Cabrita_genes, CIN_Carter_25_genes,
CIN_Carter_70_genes, ECM_Chakravarthy_up_genes, ECM_Chakravarthy_down_genes,
VEGF_Hu_genes
)
lapply(gene_lists_symbol, function(x) mapping_ensembl_to_symbol %>% filter(hgnc_symbol %in% x))
names(gene_lists_symbol) <- c(
'Hypoxia_Buffa', 'ImmuneCyt_Rooney', 'Tinflam_Ayers',
'Tinflam_Thompson', 'TLS_Cabrita', 'CIN_Carter_25',
'CIN_Carter_70', 'ECM_Chakravarthy_up', 'ECM_Chakravarthy_down',
'VEGF_Hu'
)
gene_lists_symbol
# Find the ensembl mapping of the gene list
gene_lists_symbol_ensembl <- lapply(gene_lists_symbol, function(x) mapping_ensembl_to_symbol %>% filter(hgnc_symbol %in% x))
gene_lists_symbol_ensembl
lapply(gene_lists_symbol_ensembl, function(x) x[[ensembl_gene_id]])
gene_lists_symbol_ensembl
lapply(gene_lists_symbol_ensembl, function(x) x[['ensembl_gene_id']])
geneset <- lapply(gene_lists_symbol_ensembl, function(x) x[['ensembl_gene_id']])
geneset
# Export genesets
saveRDS(geneset, 'rds/geneset.rds')
geneset
# Export genesets
saveRDS(geneset, 'rds/geneset.rds')
